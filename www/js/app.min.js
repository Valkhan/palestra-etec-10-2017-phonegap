function VLKLeiaute(){var e=this,a={htmlClass:""};e.templates={sidePanelRightEmpty:""},e.init=function(){a.htmlClass=$$("html").attr("class"),e.carregarPagina("resumo"),e.criarEventos()},e.criarEventos=function(){$$(document).on("page:init",function(a){switch(a.detail.page.name){case"camera":break;case"resumo":var o={receber:0,pagar:0,saldo:0};$VLKDatabase.regs("lancamentos",{query:function(e){"R"==e.tipo?o.receber+=toFloat(e.valor):o.pagar+=toFloat(e.valor)}}),o.saldo=o.receber-o.pagar,o.receber=toDecimal(o.receber,2),o.pagar=toDecimal(o.pagar,2),o.saldo=(parseFloat(o.saldo)>=0?"":"-")+toDecimal(o.saldo,2),$$(".page-content").append($VLKLeiaute.carregarTemplate("script#dadosResumo",o));break;case"lancamentos":var r=$VLKDatabase.regs("lancamentos",{sort:[["ID","DESC"]]});r.length>0?(r.forEach(function(e){e.classe="R"==e.tipo?"up color-green":"down color-red",e.lancamento=btod(e.lancamento),e.valor=toDecimal(e.valor,2)}),$$(".page-content").append($VLKLeiaute.carregarTemplate("script#listaLancamentos",r))):$$(".page-content").append('<div class="content-block">Nenhum lançamento efetuado!</div>')}e.eventosPagina()})},e.carregarPagina=function(e,a){myApp.closePanel();var o="views/"+e+".min.html?";(a=a||{})._nocache=moment().format("X");var r=Object.keys(a),t=r.length;if(t>0){try{n=Object.values(a)}catch(e){var n=[];for(var i in a)n.push(a[i])}for(var c=[],s=0;s<t;s++)c.push(r[s]+"="+encodeURIComponent(n[s]));o+=c.join("&")}return viewMain.router.loadPage({url:o,ignoreCache:!0})},e.carregarPopup=function(a,o,r){if(o=o||{},myApp.closePanel(),myApp.popup(e.carregarTemplate("script#"+a,o)),e.eventosPagina(),void 0!==r)return r()},e.eventosPagina=function(){var e=getTemaInfo();$$(".accordion-item").on("accordion:open",function(){$$(this).find(".item-link").addClass("bg-"+e.bg+" color-"+e.fonte)}),$$(".accordion-item").on("accordion:close",function(a){$$(this).find(".item-link").removeClass("bg-"+e.bg+" color-"+e.fonte)}),$$(".bg-padrao").removeClass("bg-padrao").addClass("bg-"+e.bg),$$(".bg-padrao2").removeClass("bg-padrao2").addClass("bg-"+e.fonte),$$(".color-padrao").removeClass("color-padrao").addClass("color-"+e.fonte),$$(".color-padrao2").removeClass("color-padrao2").addClass("color-"+e.bg),$$(".temaRequerido").addClass("color-"+e.bg),$$(".removivel").on("click",function(){var e=$$(this);e.animate({opacity:0,height:0},{duration:150}),setTimeout(function(){e.remove()},1e3)}),cssPropertyExists("flex")||($$("img.viewport100").css("max-width",.6*window.screen.width+"px"),$$("img.viewport50").css("max-width",.6*window.screen.width/2-16+"px")),$VLKConfig.getParam("producao")&&$$(".devonly").remove()},e.carregarTemplate=function(a,o){o=void 0!==o&&o;var r=getTemaInfo();return o.tema=r.bg,o.tema_fonte=r.fonte,"__"==a.substr(0,2)?(void 0!==e.templates[a]&&!1===o||(e.templates[a]=o),e.templates[a]):(void 0===e.templates[a]&&(e.templates[a]=Template7.compile($$(a).html())),o?e.templates[a](o):e.templates[a])},e.carregarTema=function(e){$$("html").attr("class",a.htmlClass+" theme-"+e)},e.tamanhoItensGaleria=function(e){$$(".galeria-item-sm").removeClass("galeria-item-sm").addClass("galeria-item-"+e),$$(".galeria-item-md").removeClass("galeria-item-md").addClass("galeria-item-"+e),$$(".galeria-item-lg").removeClass("galeria-item-lg").addClass("galeria-item-"+e),"sm"!=e?$$(".dock-badge-sm").removeClass("dock-badge-sm").addClass("dock-badge-lg"):$$(".dock-badge-lg").removeClass("dock-badge-lg").addClass("dock-badge-sm")},e.browserImagens=function(e,a){var o={photos:e,theme:"dark",type:"standalone",backLinkText:"Fechar"};return myApp.photoBrowser(Object.assign(o,a||{}))},e.init()}function VLKConfig(){var e=this,a={producao:!1,versao:"1.0.0",appName:"Controle financeiro",temaPadrao:"teal",forceConnection:"auto"};e.getParam=function(e){return void 0!==a[e]?a[e]:null},e.setParam=function(e,o){void 0!==a[e]&&(a[e]=o)},e.paginaSobre=function(){return $VLKLeiaute.carregarPopup("sobre",{aplicativo:a.appName,versao:a.versao})}}function VLKCordova(){var e=this;e.Localizacao={capturarCoordenadas:function(a,o,r){var t={maximumAge:3e3,timeout:5e3,enableHighAccuracy:!0};r=r||{},o=o||function(a){myApp.addNotification({message:"Falha na consulta: "+e.Localizacao.traduzErroCaptura(a.code),hold:HOLD_ALERTA})},navigator.geolocation.getCurrentPosition(a,o,Object.assign(t,r))},traduzErroCaptura:function(e){switch(e){case 1:return"Permissão negada!";case 2:return"Posição indisponível!";case 3:return"Tempo de consulta esgotado";default:return"Desconhecido"}}},e.Camera={capturarImagem:function(a,o,r){var t={destinationType:Camera.DestinationType.FILE_URI,quality:50,torchOn:!1};r=r||{},o=o||function(a){myApp.addNotification({message:"Falha na captura: "+e.Camera.traduzErroCaptura(a)+".",hold:HOLD_ALERTA})},navigator.camera.getPicture(a,o,Object.assign(t,r))},traduzErroCaptura:function(e){switch(e){case"Camera cancelled.":case"Selection cancelled.":return"Cancelado";case"Unable to write to file":return"Falha ao gravar arquivo";case"Can't write to external media storage.":return"Não foi possível gravar no armazenamento externo.";case"Can't write to internal media storage.":return"Não foi possível gravar no armazenamento interno.";case"Did not complete!":case"Error capturing image.":case"Selection did not complete!":default:return"Não foi possível completar a captura"}},capturarCodBarras:function(e,a,o){var r={preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!0,prompt:"Posicione o código de barras dentro da área do scanner!",resultDisplayDuration:500,formats:"QR_CODE,PDF_417"};o=o||{},a=a||function(e){myApp.addNotification({message:"Falha na leitura: "+e})},cordova.plugins.barcodeScanner.scan(e,a,Object.assign(r,o))}},e.Arquivo={uploadArquivo:function(e,a,o,r){o=o||function(e){myApp.addNotification({message:"Code = "+e.responseCode}),myApp.addNotification({message:"Response = "+e.response}),myApp.addNotification({message:"Sent = "+e.bytesSent})},r=r||function(e){myApp.Alert("An error has occurred: Code = "+e.code),myApp.addNotification({message:"upload error source "+e.source}),myApp.addNotification({message:"upload error target "+e.target})},a=a||{};var t=new FileUploadOptions("file");return t.fileName=e.substr(e.lastIndexOf("/")+1),t.mimeType="image/jpeg",t.params={},t.headers={key:$VLKConfig.sync.getToken().key,apiversion:$VLKConfig.getParam("versaoAPI")},(new FileTransfer).upload(e,encodeURI($VLKConfig.getParam("syncUrl")+"index.php?oper=uploadDados"),o,r,Object.assign(t,a))},removerArquivo:function(e,a,o){return o=o||function(e,a){$VLKConfig.getParam("producao")||myApp.addNotification({message:"Erro ao realizar download da imagem: "+e.code,hold:HOLD_ERRO})},a=a||function(){},window.resolveLocalFileSystemURL(e,function(r){r.remove(function(o){return $VLKConfig.getParam("producao")||myApp.addNotification({message:"Arquivo removido com sucesso: "+e,hold:HOLD_ALERTA}),a()},function(e){return o(e)})},function(e){return o(e)})},lerDiretorio:function(e,a,o){o=o||function(e,a){$VLKConfig.getParam("producao")||myApp.addNotification({message:"Erro: "+a+"("+e.code+"): "})},a=a||function(e){return e},window.resolveLocalFileSystemURL(e,function(e){e.createReader().readEntries(a,function(e){return o(e,"fileSystem")})},function(e){return o(e,"resolveLocalFileSystemURL")})},download:function(e,a,o,r){return(new FileTransfer).download(encodeURI(e),a,o,r,!0,{})},apagarDiretorio:function(e,a,o){return o=function(e){var a=e.code;switch(e.code){case 1:a="Diretório não encontrado!";break;case 2:a="Permissão negada!";break;case 3:a="Abortado!";break;case 4:a="Não foi possível realizar leitura!";break;case 5:a="Erro de codificação!";break;case 6:a="Não é permitido realizar modificações!";break;case 7:a="Estado inválido!";break;case 8:a="Erro de sintaxe!";break;case 9:a="Modificação inválida!";break;case 10:a="Quota excedida!";break;case 11:a="Tipos incorretos!";break;case 12:a="Caminho não existe!"}$VLKConfig.getParam("producao")||myApp.addNotification({message:"Ocorreu um erro ao apagar o diretório informado: "+a,hold:HOLD_ERRO})},a=function(e){e.isDirectory&&e.removeRecursively(function(a){$VLKConfig.getParam("producao")||myApp.addNotification({message:"Diretório "+e.name+" removido com sucesso!",hold:HOLD_ALERTA})},o)},window.resolveLocalFileSystemURL(e,a,o)}},e.Dispositivo={getInfo:function(e){return"undefined"!=typeof device?void 0===e?device:void 0!==device[e]&&device[e]:void 0}}}function VLKDatabase(){var e=this,a={permitirInclusaoAlteracao:!0,resetOnInit:!1,dbname:"vlkcontrolefinanceiro"},o=new localStorageDB(a.dbname,localStorage),r={__controle:{ID:{tipo:"autoincrement",valor_padrao:"",validacao:"",requerido:!1},app_cri:{tipo:"datetime",valor_padrao:"v::datetime",validacao:"",requerido:!1},app_alt:{tipo:"datetime",valor_padrao:"v::datetime",validacao:"",requerido:!1}},lancamentos:{descricao:{tipo:"str",valor_padrao:"",validacao:"",requerido:!0},valor:{tipo:"float",valor_padrao:"",validacao:"",requerido:!0},tipo:{tipo:"str",valor_padrao:"R",validacao:"",requerido:!0},lancamento:{tipo:"str",valor_padrao:"v::date",validacao:"",requerido:!0}},__isNumber:function(e,a){switch(r[e][a].tipo){case"int":case"float":case"autoincrement":return!0;default:return!1}},__valorPadrao:function(e,a){var o;if(""!==r[e][a].valor_padrao){var t="v::"==r[e][a].valor_padrao.substr(0,3)?r[e][a].valor_padrao.substr(3):r[e][a].valor_padrao,n=t;if(-1!==t.indexOf("(")){var i=t.indexOf("("),c=t.indexOf(")");n=t.substr(0,i),t.substr(i+1,c-i-1)}switch(n){case"datetime":o=(new Date).getTime();break;case"datahora":o=moment().format("YYYY-MM-DD HH:mm");break;case"date":o=moment().format("YYYY-MM-DD");break;case"hour":o=moment().format("HH:mm");break;default:r.__isNumber(e,a)?"int"==r[e][a].tipo||"autoincrement"==r[e][a].tipo?o=parseInt(t):"float"==r[e][a]&&(o=parseFloat(t)):o=t}}else o=r.__isNumber(e,a)?0:"";return o},__getFields:function(e){return[].concat(Object.keys(r.__controle),Object.keys(r[e]))}};e.removerDuplicados=function(a,o,r){var t=e.regs(a,{query:function(e){var a=!0;for(var t in o)a=a&&e[o[t]]==r[t];return a},sort:[["app_alt","ASC"]]});t.length>1&&(t.pop(),t.forEach(function(o){e.delete(a,o.ID)}))},e.novoObj=function(e){if(r[e]){var a={};for(var o in r[e])a[o]=r.__valorPadrao(e,o);return a}return!1},e.validarObj=function(e,a,o){o=o||"I";var t=void 0!==a,n=[];if(t)switch(o){case"I":for(var i in r.__controle)void 0===a[i]&&(a[i]=r.__valorPadrao("__controle",i));break;case"A":a.app_alt=r.__valorPadrao("__controle","app_alt");break;case"S":a.app_syn=r.__valorPadrao("__controle","app_alt")}else n.push("Objeto recebido é nulo!");return t?a:{erros:n}},e.insert=function(r,t){return a.permitirInclusaoAlteracao?(t=e.validarObj(r,t,"I"),void 0===t.erros?(t.ID=o.insert(r,t),void 0!==t.ID?(o.commit(),t):{erros:["Falha ao incluir registro no banco de dados"]}):t):{erros:"Banco de dados cheio!"}},e.update=function(r,t){if(a.permitirInclusaoAlteracao&&void 0===(t=e.validarObj(r,t,"A")).erros&&void 0!==t.ID){var n=o.update(r,{ID:t.ID},function(e){return t});return void 0!==n&&n>0&&(o.commit(),!0)}return!1},e.updateFunc=function(r,t,n){if(a.permitirInclusaoAlteracao&&void 0===(n=e.validarObj(r,n,"A")).erros){var i=o.update(r,t,function(e){for(var a in n)"ID"!==a&&void 0!==e[a]&&(e[a]=n[a]);return e});return void 0!==i&&i>0&&(o.commit(),!0)}return!1},e.delete=function(r,t){return void 0!==o.deleteRows(r,{ID:t})&&(o.commit(),a.permitirInclusaoAlteracao=e.getDBSize(),!0)},e.deleteWhere=function(r,t){return void 0!==o.deleteRows(r,t)&&(o.commit(),a.permitirInclusaoAlteracao=e.getDBSize(),!0)},e.truncate=function(e){o.truncate(e),o.commit()},e.regs=function(e,a){return a=a||{},o.queryAll(e,a)},e.ultimoIdTabela=function(e){return o.tableExists(e)?JSON.parse(o.serialize()).tables[e].auto_increment-1:0},e.init=function(){if(!window.localStorage)return myApp.addNotification({message:"Dispositivo incompatível!",hold:HOLD_ERRO});a.permitirInclusaoAlteracao=e.getDBSize(),a.resetOnInit&&(o.drop(),o=new localStorageDB(a.dbname,localStorage)),e.corrigirIntegridade()},e.corrigirIntegridade=function(){var a=[];for(var t in r)"__"===t.substr(0,2)||o.tableExists(t)?"__"!==t.substr(0,2)&&(a.push(t),r.__getFields(t).sort().forEach(function(e){o.columnExists(t,e)||o.alterTable(t,e)})):(a.push(t),o.createTable(t,r.__getFields(t)));e.getTables().forEach(function(e){-1===a.indexOf(e)&&o.dropTable(e)}),o.commit()},e.getTables=function(){var e=JSON.parse(o.serialize());return Object.keys(e.tables)},e.getInstance=function(){return o},e.getDBSize=function(){return localStorage.getItem("db_"+a.dbname).length<5e6},e.getConfig=function(e){return void 0===a[e]?null:a[e]},e.reset=function(t){if(t=t||!1){o.drop(),o=new localStorageDB(a.dbname,localStorage);for(var n in r)"__"!==n.substr(0,2)&&o.createTable(n,r.__getFields(n))}else for(var n in r)"__"!==n.substr(0,2)&&"usuarios"!==n&&e.truncate(n);myApp.addNotification({message:"Reset finalizado",hold:HOLD_INFORMACAO})},e.getCamposControle=function(){return Object.keys(r.__controle)},e.init()}var myApp=new Framework7({material:!0,swipePanel:"left",modalTitle:"Controle financeiro",modalButtonCancel:"Cancelar",modalPreloaderTitle:"Carregando...",modalUsernamePlaceholder:"Usuário",modalPasswordPlaceholder:"Senha",smartSelectBackText:"Voltar",smartSelectPopupCloseText:"Fechar",smartSelectPickerCloseText:"Pronto",notificationCloseButtonText:"Fechar",onAjaxStart:function(){myApp.showIndicator()},onAjaxComplete:function(){myApp.hideIndicator()},tapHold:!1});window.onerror=function(e,a,o){myApp.addNotification({message:"Erro JS: "+a.split("/").pop()+" ("+o+") Desc: "+e})};var $$=Dom7,viewMain=myApp.addView(".view-main",{}),$VLKDatabase=new VLKDatabase,$VLKConfig=new VLKConfig,$VLKLeiaute=new VLKLeiaute,$VLKCordova=new VLKCordova;$$(document).on("deviceready",function(){$VLKLeiaute.init(),$VLKConfig.getParam("producao")||myApp.addNotification({message:"Conexão: "+checkConnection(!0),hold:HOLD_INFORMACAO})});